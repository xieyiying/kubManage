webpackJsonp([11],{kEYP:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("Izdj"),s=r("wWxp"),a=r("R2SV"),l=r("aYpo"),i={name:"editNewsMsg",mixins:[o.a],components:{VueEditor:l.VueEditor},data:function(){return{tableTitle:"",form:{isPublish:0},rules:{languageType:[{required:!0,message:"请选择语言",trigger:"blur"}],newsType:[{required:!0,message:"请选择新闻类型",trigger:"blur"}],sort:[{required:!0,validator:function(e,t,r){t?1==/[^\d]/g.test(t)?r(new Error("请输入数字！")):r():r(new Error("请输入新闻排序！"))},trigger:"blur"}],newDescr:[{required:!0,message:"请输入新闻表述",trigger:"blur"}],newsPhotoUrl:[{required:!0,message:"请选择新闻封面图片"}],title:[{required:!0,message:"请输入新闻标题",trigger:"blur"}],newTitle:[{required:!0,message:"请输入新闻详情标题",trigger:"blur"}],newsDate:[{required:!0,message:"请选择新闻日期时间",trigger:"blur"}],isPublish:[{required:!0,message:"请选择是否发布",trigger:"blur"}],content:[{required:!0,message:"请输入新闻内容",trigger:"blur"}]},languageList:[],newsTypeList:[],newsPhotoUrl:[],isGetSort:!1}},methods:{getSingleData:function(e){var t=this;s.o.updateData({id:e}).then(function(r){t.newsPhotoUrl.push({url:r.body.kubNavigatHome.newsPhotoUrl}),t.$set(t.form,"languageType",r.body.kubNavigatHome.languageType),t.$set(t.form,"newsType",r.body.kubNavigatHome.newsType),t.$set(t.form,"sort",r.body.kubNavigatHome.sort),t.$set(t.form,"newDescr",r.body.kubNavigatHome.newDescr),t.$set(t.form,"newsPhotoUrl",r.body.kubNavigatHome.newsPhotoUrl),t.$set(t.form,"title",r.body.kubNavigatHome.title),t.$set(t.form,"newTitle",r.body.kubNavigatHome.newTitle),t.$set(t.form,"newsDate",r.body.kubNavigatHome.newsDate),t.$set(t.form,"isPublish",parseInt(r.body.kubNavigatHome.isPublish)),t.$set(t.form,"content",r.body.kubNavigatHome.content),t.$set(t.form,"id",e)})},languageChange:function(e){var t=this;this.isGetSort&&s.o.getNewsSort({languageType:e}).then(function(e){t.$set(t.form,"sort",e)})},getNewsType:function(){var e=this;s.o.getNewsType({}).then(function(t){e.newsTypeList=t})},uploadSuccess:function(e,t,r,o){this.$set(this.form,o,e)},uploadRemove:function(e,t,r){this.$set(this.form,r,[])},onSubmit:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return t.$message.warning("保存失败，请填写完整信息！"),!1;s.o.saveData(t.form).then(function(r){Object(a.b)(t.$route.query.title),r.success&&(t.newsPhotoUrl=[],t.$refs[e].resetFields(),t.form.isPublish=0,t.$router.push({path:"/newsManage"}))})})},backHomeManage:function(e){this.form={isPublish:0},this.newsPhotoUrl=[],this.$refs[e].resetFields(),this.$router.push({path:"/newsManage"})},changeGetSort:function(e){"编辑"===e?this.isGetSort=!1:"新增"===e&&(this.isGetSort=!0)}},created:function(){this.tableTitle=this.$route.query.title+"数据",this.getNewsType()},activated:function(){this.changeGetSort(this.$route.query.title),this.$route.query.id?this.getSingleData(this.$route.query.id):(this.form={isPublish:0},this.newsPhotoUrl=[])}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"scrollBox",staticClass:"edit_message"},[r("c-breadcrumb",{attrs:{tableTitle:e.tableTitle}}),e._v(" "),r("div",{staticClass:"container"},[r("div",{staticClass:"form-box"},[r("el-form",{ref:"form",staticStyle:{width:"900px"},attrs:{model:e.form,"label-width":"130px",rules:e.rules}},[r("el-form-item",{attrs:{label:"语言类型：",prop:"languageType"}},[r("el-select",{attrs:{placeholder:"请选择语言"},on:{change:e.languageChange},model:{value:e.form.languageType,callback:function(t){e.$set(e.form,"languageType",t)},expression:"form.languageType"}},e._l(e.languageList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻类型：",prop:"newsType"}},[r("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:e.form.newsType,callback:function(t){e.$set(e.form,"newsType",t)},expression:"form.newsType"}},e._l(e.newsTypeList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻排序：",prop:"sort"}},[r("el-input",{attrs:{placeholder:"请输入新闻排序"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻表述：",prop:"newDescr"}},[r("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入新闻表述"},model:{value:e.form.newDescr,callback:function(t){e.$set(e.form,"newDescr",t)},expression:"form.newDescr"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻封面图片：",prop:"newsPhotoUrl"}},[r("c-upload",{attrs:{fileList:e.newsPhotoUrl,imageName:"newsPhotoUrl"},on:{"on-success":e.uploadSuccess,"on-remove":e.uploadRemove}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻标题：",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入新闻标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻详情标题：",prop:"newTitle"}},[r("el-input",{attrs:{placeholder:"请输入新闻详情标题"},model:{value:e.form.newTitle,callback:function(t){e.$set(e.form,"newTitle",t)},expression:"form.newTitle"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻时间：",prop:"newsDate"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择新闻日期时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.form.newsDate,callback:function(t){e.$set(e.form,"newsDate",t)},expression:"form.newsDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否发布：",prop:"isPublish"}},[r("el-radio-group",{model:{value:e.form.isPublish,callback:function(t){e.$set(e.form,"isPublish",t)},expression:"form.isPublish"}},[r("el-radio",{attrs:{label:1}},[e._v("发布")]),e._v(" "),r("el-radio",{attrs:{label:0}},[e._v("不发布")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"新闻内容：",prop:"content"}},[r("vue-editor",{attrs:{name:"imageContent",useCustomImageHandler:""},on:{imageAdded:e.handleImageAdded},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("form")}}},[e._v("保存")]),e._v(" "),r("el-button",{on:{click:function(t){e.backHomeManage("form")}}},[e._v("取消")])],1)],1)],1)])],1)},staticRenderFns:[]},u=r("VU/8")(i,n,!1,null,null,null);t.default=u.exports}});